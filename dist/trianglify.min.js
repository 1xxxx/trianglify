function Trianglify(r){function e(r,e,o){return(r-e[0])*(o[1]-o[0])/(e[1]-e[0])+o[0]}function o(o,l){for(var t=[],n=-h;o+h>n;n+=r.cell_size)for(var i=-g;l+g>i;i+=r.cell_size){var a=n+r.cell_size/2+e(Math.random(),[0,1],[-_,_]),c=i+r.cell_size/2+e(Math.random(),[0,1],[-_,_]);t.push([a,c])}return t}function l(r){return{x:(r[0][0]+r[1][0]+r[2][0])/3,y:(r[0][1]+r[1][1]+r[2][1])/3}}function t(){var r=Object.keys(colorbrewer),e=colorbrewer[r[Math.floor(Math.random()*r.length)]];r=Object.keys(e);var o=e[r[Math.floor(Math.random()*r.length)]];return o}function n(r,e){var o={};for(var l in r)o[l]=r[l];for(l in e){if(!r.hasOwnProperty(l))throw new Error(l+" is not a configuration option for Trianglify. Check your spelling?");o[l]=e[l]}return o}var i=t(),a=n(defaults,{x_colors:i,y_colors:i});r=n(a,r);var c=r.width,s=r.height,u=Math.floor((c+2*r.cell_size)/r.cell_size),f=Math.floor((s+2*r.cell_size)/r.cell_size),h=(u*r.cell_size-c)/2,g=(f*r.cell_size-s)/2,_=(r.cell_size-2*r.cell_padding)/2,d=colorutils.get_2d_gradient(r.x_colors,r.y_colors),y=function(r){return e(r,[-h,c+h],[0,1])},w=function(r){return e(r,[-g,s+g],[0,1])};if(!(c>0&&s>0))throw new Error("Width and height must be numbers greater than 0");for(var v=o(c,s),b=Delaunay.triangulate(v),z=[],p=function(r){return v[r]},m=0;m<b.length;m+=3){var x,M=[b[m],b[m+1],b[m+2]].map(p),A=l(M);try{x=d(y(A.x),w(A.y)).hexString()}catch(q){throw console.log("width: ",c),console.log("bleed_x, bleed_y: ",h,g),console.log("points: ",v),console.log("vertices: ",M),console.log("centroid: ",A),q}z.push([x,M])}return Pattern(z,r)}var Delaunay=require("delaunay-fast"),Color=require("color"),colorbrewer=require("./colorbrewer"),Pattern=require("./pattern"),colorutils=require("./colorutils"),defaults={cell_size:50,cell_padding:10,x_colors:["#222","#AAA"],y_colors:["#222","#AAA"],color_function:null,width:600,height:400};Trianglify.colorbrewer=colorbrewer,Trianglify.defaults=defaults,module.exports=Trianglify;